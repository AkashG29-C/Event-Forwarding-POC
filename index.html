<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Event Forwarding POC</title>
  <script>
    window.alloy_alloy = {
      edgeConfigId: "993a5934-4f41-4827-a059-00508caf6325",
      orgId: "0CEB60F754C7E06B0A4C98A2@AdobeOrg"
    };
  </script>
  <script src="https://assets.adobedtm.com/e72b4113c11a/dea835227b36/launch-5cc6da518e0d-development.min.js" async></script>
</head>
<body>
  <h2>Submit Form Example</h2>

  <!-- Email -->
  <label>Email: </label>
  <input type="email" id="emailInput" placeholder="Enter email">
  <button onclick="submitEmail()">Submit Email</button>
  <br><br>

  <!-- Name -->
  <label>Name: </label>
  <input type="text" id="nameInput" placeholder="Enter name">
  <button onclick="submitName()">Submit Name</button>
  <br><br>

  <!-- Age -->
  <label>Age: </label>
  <input type="number" id="ageInput" placeholder="Enter age">
  <button onclick="submitAge()">Submit Age</button>

  <script>
    function getDeviceType() {
      const ua = navigator.userAgent;
      if (/mobile/i.test(ua)) return "Mobile";
      if (/tablet/i.test(ua)) return "Tablet";
      return "Desktop";
    }

    function getEmailValue() {
      return document.getElementById("emailInput").value.trim();
    }

    function submitEmail() {
      const email = getEmailValue();
      alloy("sendEvent", {
        xdm: {
          eventType: "email_submit",
          web: { webPageDetails: { URL: window.location.href } },
          device: { type: getDeviceType() },
          person: { email: { address: email } }
        },
        identities: {
          ECID: {},
          email: {
            id: email,
            authenticatedState: "authenticated"
          }
        }
      });
    }

    function submitName() {
      const name = document.getElementById("nameInput").value.trim();
      const email = getEmailValue();
      alloy("sendEvent", {
        xdm: {
          eventType: "name_submit",
          web: { webPageDetails: { URL: window.location.href } },
          device: { type: getDeviceType() },
          person: { name: { firstName: name } }
        },
        identities: {
          ECID: {},
          email: {
            id: email,
            authenticatedState: "authenticated"
          }
        }
      });
    }

    function submitAge() {
      const age = document.getElementById("ageInput").value.trim();
      const email = getEmailValue();
      alloy("sendEvent", {
        xdm: {
          eventType: "age_submit",
          web: { webPageDetails: { URL: window.location.href } },
          device: { type: getDeviceType() },
          person: { personalDetails: { age: age } }
        },
        identities: {
          ECID: {},
          email: {
            id: email,
            authenticatedState: "authenticated"
          }
        }
      });
    }
  </script>
</body>
</html>
